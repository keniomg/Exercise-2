using System;
using System.Linq;

namespace lessons
{
    class program
    {
        static void Main()
        {
            const string ExitCommand = "exit";
            const string ExchangeEnterCommand = "1";
            const string ExchangeRateCommand = "2";
            const string BalanceInfoCommand = "3";
            const string ConvertRubToUsdCommand = "1";
            const string ConvertRubToEuroCommand = "2";
            const string ConvertUsdToRubCommand = "3";
            const string ConvertUsdToEuroCommand = "4";
            const string ConvertEuroToRubCommand = "5";
            const string ConvertEuroToUsdCommand = "6";

            bool isWorking = true;
            string exchangeEnter = "Обмен валюты";
            string exchangeRate = "Узнать курс обмена";
            string balanceInfo = "Узнать баланс";
            string exitMessage = $"Для выхода из программы введите '{ExitCommand}' в любой момент";
            float fullPercent = 100f;
            float comissionPercent = 7.3f;
            float exchangePercent = (fullPercent - comissionPercent) / 100;
            float dollar = 100.65f;
            float euro = 110.13f;
            float ruble = 1f;
            string userCommand = "0";
            float rubleBalance;
            float dollarBalance;
            float euroBalance;
            string rubleToExchange = null;
            float rubleToExchangeAmount;
            string dollarToExchange = null;
            float dollarToExchangeAmount;
            string euroToExchange = null;
            float euroToExchangeAmount;
            float dollarToRuble = dollar / ruble * exchangePercent;
            float dollarToEuro = dollar / euro * exchangePercent;
            float euroToRuble = euro / ruble * exchangePercent;
            float euroToDollar = euro / dollar * exchangePercent;
            float rubleToDollar = ruble / dollar * exchangePercent;
            float rubleToEuro = ruble / euro * exchangePercent;
            string[] validExchangeCommands = { ConvertRubToUsdCommand, ConvertRubToEuroCommand, ConvertUsdToRubCommand,
                ConvertUsdToEuroCommand, ConvertEuroToRubCommand, ConvertEuroToUsdCommand, ExitCommand };
            string[] mainCommands = { ExchangeEnterCommand, ExchangeRateCommand, BalanceInfoCommand }; 
            Console.WriteLine($"Приветствуем вас в нашем валютообменнике.\nЧтобы продолжить, нажмите 'Enter'\n{exitMessage}\n");
            Console.WriteLine("\nСколько у вас рублей?:\n");
            string rubleInput = Console.ReadLine();

            while (float.TryParse(rubleInput, out rubleBalance) == false && rubleInput != ExitCommand)
            {
                Console.WriteLine("\nВведите число корректно или выйдите из программы\n");
                rubleInput = Console.ReadLine();
                
                if (rubleInput == ExitCommand)
                {
                    isWorking = false;
                }
            }

            Console.WriteLine("\nСколько у вас долларов?:\n");
            string dollarInput = Console.ReadLine();

            while (float.TryParse(dollarInput, out dollarBalance) == false && dollarInput != ExitCommand)
            {
                Console.WriteLine("\nВведите число корректно или выйдите из программы\n");
                dollarInput = Console.ReadLine();
            }

            Console.WriteLine("\nСколько у вас евро?:\n");
            string euroInput = Console.ReadLine();

            while (float.TryParse(euroInput, out euroBalance) == false)
            {
                if (euroInput == ExitCommand)
                {
                    return;
                }

                Console.WriteLine("\nВведите число корректно или выйдите из программы\n");
                euroInput = Console.ReadLine();
            }

            Console.WriteLine();

            while (isWorking)
            {
                if (float.TryParse(userCommand, out _) == true)
                {
                    Console.Clear();
                    Console.WriteLine($"Вы можете выполнить одну из следующих операций:\n\n{ExchangeEnterCommand} - {exchangeEnter}\n" +
                        $"{ExchangeRateCommand} - {exchangeRate}\n{BalanceInfoCommand} - {balanceInfo}\n");
                }

                userCommand = Console.ReadLine();

                if (mainCommands.Contains(userCommand) == true)
                {
                    Console.Clear();

                    switch (userCommand)
                    {
                        case ExchangeEnterCommand:
                            Console.WriteLine($"Какой обмен вы хотите совершить?\n{ConvertRubToUsdCommand} - рубли на доллары\n" +
                            $"{ConvertRubToEuroCommand} - рубли на евро\n{ConvertUsdToRubCommand} - доллары на рубли\n{ConvertUsdToEuroCommand}" +
                            $" - доллары на евро\n{ConvertEuroToRubCommand} - евро на рубли\n{ConvertEuroToUsdCommand} - евро на доллары\n");
                            userCommand = Console.ReadLine();

                            while (validExchangeCommands.Contains(userCommand) == false)
                            {
                                Console.WriteLine("\nВведите число корректно или выйдите из программы\n");
                                userCommand = Console.ReadLine();
                            }

                            switch (userCommand)
                            {
                                case ConvertRubToUsdCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько рублей вы хотите обменять на доллары?:\n");
                                    rubleToExchange = Console.ReadLine();

                                    while (float.TryParse(rubleToExchange, out rubleToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (rubleToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            rubleToExchange = Console.ReadLine();
                                        }
                                    }

                                    rubleBalance -= rubleToExchangeAmount;
                                    dollarBalance += (rubleToExchangeAmount * rubleToDollar);
                                    break;

                                case ConvertRubToEuroCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько рублей вы хотите обменять на евро?:\n");
                                    rubleToExchange = Console.ReadLine();

                                    while (float.TryParse(rubleToExchange, out rubleToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (rubleToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            rubleToExchange = Console.ReadLine();
                                        }
                                    }

                                    rubleBalance -= rubleToExchangeAmount;
                                    euroBalance += (rubleToExchangeAmount * rubleToEuro);
                                    break;

                                case ConvertUsdToRubCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько долларов вы хотите обменять на рубли?:\n");
                                    dollarToExchange = Console.ReadLine();

                                    while (float.TryParse(dollarToExchange, out dollarToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (dollarToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            dollarToExchange = Console.ReadLine();
                                        }
                                    }

                                    dollarBalance -= dollarToExchangeAmount;
                                    rubleBalance += (dollarToExchangeAmount * dollarToRuble);
                                    break;

                                case ConvertUsdToEuroCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько долларов вы хотите обменять на евро?:\n");
                                    dollarToExchange = Console.ReadLine();

                                    while (float.TryParse(dollarToExchange, out dollarToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (dollarToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            dollarToExchange = Console.ReadLine();
                                        }
                                    }

                                    dollarBalance -= dollarToExchangeAmount;
                                    euroBalance += (dollarToExchangeAmount * dollarToEuro);
                                    break;

                                case ConvertEuroToRubCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько евро вы хотите обменять на рубли?:\n");
                                    euroToExchange = Console.ReadLine();

                                    while (float.TryParse(euroToExchange, out euroToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (euroToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            euroToExchange = Console.ReadLine();
                                        }
                                    }

                                    euroBalance -= euroToExchangeAmount;
                                    rubleBalance += (euroToExchangeAmount * euroToRuble);
                                    break;

                                case ConvertEuroToUsdCommand:
                                    Console.Clear();
                                    Console.WriteLine("Сколько евро вы хотите обменять на рубли?:\n");
                                    euroToExchange = Console.ReadLine();

                                    while (float.TryParse(euroToExchange, out euroToExchangeAmount) == false || rubleToExchange == ExitCommand)
                                    {
                                        Console.WriteLine();

                                        if (euroToExchange == ExitCommand)
                                        {
                                            isWorking = false;
                                            break;
                                        }
                                        else
                                        {
                                            Console.WriteLine("Введите число корректно или выйдите из программы\n");
                                            euroToExchange = Console.ReadLine();
                                        }
                                    }

                                    euroBalance -= euroToExchangeAmount;
                                    dollarBalance += (euroToExchangeAmount * euroToDollar);
                                    break;

                                case ExitCommand:
                                    Console.WriteLine();
                                    isWorking = false;
                                    break;

                                default:
                                    break;
                            }

                            if (isWorking)
                            {
                                Console.Clear();
                                Console.WriteLine($"Теперь в вашем кошельке:\n \nрублей: {rubleBalance} \nдолларов: {dollarBalance}\nевро: {euroBalance}");
                            }

                            break;

                        case ExchangeRateCommand:
                        Console.WriteLine($"Текущий курс обмена:\n1 рубль = \nдолларов: {rubleToDollar}\nевро: {rubleToEuro}\n" +
                            $"\n1 доллар = \nрублей: {dollarToRuble}\nевро: {dollarToEuro}\n\n1 евро = \nдолларов: {euroToDollar}" +
                            $"\nрублей: {euroToRuble}");
                            break;

                        case BalanceInfoCommand:
                            Console.WriteLine($"В вашем кошельке:\n \nрублей: {rubleBalance} \nдолларов: {dollarBalance}\nевро: {euroBalance}");
                            break;

                        default:
                            break;
                    }

                    if (isWorking == true)
                    {
                        Console.WriteLine("\nНажмие любую клавишу, чтобы продолжить...");
                        Console.ReadKey();
                        Console.Clear();

                    }
                }
                else if (userCommand == ExitCommand)
                {
                    isWorking = false;
                }
                else
                {
                    Console.WriteLine("\nВведите корректную команду или выйдите из программы\n");
                }
            }
        }
    }
}
